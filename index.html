import React, { useState, useEffect, useRef } from 'react';
import { 
  ThumbsUp, 
  MessageSquare, 
  Share2, 
  MoreHorizontal, 
  Bell, 
  Search, 
  Menu, 
  Check,
  X
} from 'lucide-react';

const App = () => {
  const [liked, setLiked] = useState(false);
  const [subscribed, setSubscribed] = useState(false);
  const [likeCount, setLikeCount] = useState(125432);
  const [commentText, setCommentText] = useState('');
  const [showShareTooltip, setShowShareTooltip] = useState(false);
  const [isDescriptionExpanded, setIsDescriptionExpanded] = useState(false);
  
  // Aether Logo URL
  const aetherLogo = "https://files.catbox.moe/nj82iu.png";

  const videoData = {
    title: "AETHERâ€™s INTRODUCTION: Taking Over Vietnam By Van ðŸšðŸ‡»ðŸ‡³",
    views: "4,203,912",
    date: "Feb 2, 2026",
    description: "Breaking news: All flights to Vietnam are sold out! Join the Aether team as we explore the unique culture, traditions, and landscapes of Vietnam in our trusty van.\n\nFrom Tam Coc to the bustling streets, we're redefining what it means to travel. We encountered amazing people, tasted incredible food, and learned that the journey is just as important as the destination.\n\nSpecial thanks to our local guides and the amazing communities that welcomed us.\n\n#AetherTravel #Vietnam #VanLife #TravelVlog #Culture #Adventure",
    channel: "Aether Official",
    subscribers: "980K"
  };

  const [comments, setComments] = useState([
    { id: 1, user: "TravelJunkie99", avatar: "bg-purple-500", text: "Can't believe they actually drove a van through the whole country! The dedication is insane. ðŸšðŸ‡»ðŸ‡³", likes: "12K", time: "2 hours ago" },
    { id: 2, user: "CinematicVisions", avatar: "bg-blue-500", text: "The color grading on this is next level. That shot of Tam Coc took my breath away. ðŸ“¸âœ¨", likes: "8.5K", time: "5 hours ago" },
    { id: 3, user: "FoodieExplorer", avatar: "bg-green-500", text: "Okay, but can we talk about that food montage? I'm literally drooling. ðŸœðŸ¤¤", likes: "5.2K", time: "1 day ago" },
    { id: 4, user: "TechNomad", avatar: "bg-red-500", text: "Wait, did the CEO just approve the van at the end? ðŸ˜‚ Love the energy of this team!", likes: "3.1K", time: "1 day ago" },
    { id: 5, user: "Wanderlust_Annie", avatar: "bg-yellow-500", text: "Vietnam is officially on my bucket list now. Thanks Aether for showing the hidden gems! ðŸŒ", likes: "2.9K", time: "2 days ago" },
    { id: 6, user: "LocalGuideHN", avatar: "bg-indigo-500", text: "So happy to see you sharing our culture with the world! The ao dai looks beautiful. ðŸ‡»ðŸ‡³â¤ï¸", likes: "15K", time: "3 days ago" },
  ]);

  const handleLike = () => {
    if (liked) {
      setLikeCount(prev => prev - 1);
    } else {
      setLikeCount(prev => prev + 1);
    }
    setLiked(!liked);
  };

  const handleSubscribe = () => {
    setSubscribed(!subscribed);
  };

  const handleShare = () => {
    navigator.clipboard.writeText("https://www.youtube.com/watch?v=_3hyK1OmK0I");
    setShowShareTooltip(true);
    setTimeout(() => setShowShareTooltip(false), 2000);
  };

  const handleCommentSubmit = (e) => {
    e.preventDefault();
    if (!commentText.trim()) return;
    
    const newComment = {
      id: Date.now(),
      user: "You",
      avatar: "bg-gray-400",
      text: commentText,
      likes: "0",
      time: "Just now"
    };
    
    setComments([newComment, ...comments]);
    setCommentText('');
  };

  const formatNumber = (num) => {
    return new Intl.NumberFormat('en-US', { notation: "compact", compactDisplay: "short" }).format(num);
  };

  return (
    <div className="bg-[#0f0f0f] text-white min-h-screen font-sans flex flex-col">
      {/* Navbar */}
      <nav className="fixed top-0 left-0 right-0 h-14 bg-[#0f0f0f] flex items-center justify-between px-4 z-50 border-b border-gray-800">
        <div className="flex items-center gap-4">
          <button className="p-2 hover:bg-gray-800 rounded-full">
            <Menu size={24} />
          </button>
          <div className="flex items-center gap-2 cursor-pointer">
            <img src={aetherLogo} alt="Aether Logo" className="w-8 h-8 rounded-full object-cover" />
            <span className="text-xl font-bold tracking-tight hidden md:block">Aether</span>
          </div>
        </div>

        <div className="hidden sm:flex flex-1 max-w-2xl mx-4">
          <div className="flex w-full">
            <input 
              type="text" 
              placeholder="Search Aether..." 
              className="w-full bg-[#121212] border border-gray-700 rounded-l-full py-2 px-4 focus:outline-none focus:border-blue-500 text-gray-300"
            />
            <button className="bg-[#222] border border-l-0 border-gray-700 rounded-r-full px-5 hover:bg-gray-700 text-gray-400">
              <Search size={20} />
            </button>
          </div>
        </div>

        <div className="flex items-center gap-3">
          <button className="p-2 hover:bg-gray-800 rounded-full text-gray-300 relative">
            <Bell size={24} />
            <span className="absolute top-1 right-1 w-4 h-4 bg-red-600 rounded-full text-[10px] flex items-center justify-center text-white border-2 border-[#0f0f0f]">9+</span>
          </button>
          <div className="w-8 h-8 bg-gray-600 rounded-full cursor-pointer overflow-hidden border border-gray-700">
            <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="User" />
          </div>
        </div>
      </nav>

      <div className="flex pt-14 h-[calc(100vh-56px)] justify-center">
        {/* Main Content */}
        <main className="flex-1 overflow-y-auto p-4 lg:p-6 bg-[#0f0f0f] max-w-[1600px]">
          <div className="flex flex-col lg:flex-row gap-6">
            
            {/* Left Column: Video & Comments */}
            <div className="flex-1">
              {/* Video Player Wrapper */}
              <div className="relative w-full aspect-video bg-black rounded-xl overflow-hidden shadow-2xl shadow-purple-900/10 mb-4 group">
                 <video 
                  className="w-full h-full object-contain"
                  src="https://files.catbox.moe/xv8sgh.mp4" 
                  controls
                  autoPlay
                ></video>
              </div>

              {/* Video Title */}
              <h1 className="text-xl md:text-2xl font-bold mb-2 line-clamp-2">{videoData.title}</h1>

              {/* Action Bar */}
              <div className="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-4">
                <div className="flex items-center gap-3">
                  <img src={aetherLogo} alt={videoData.channel} className="w-10 h-10 rounded-full object-cover cursor-pointer hover:scale-105 transition-transform" />
                  <div className="flex flex-col">
                    <span className="font-bold text-white hover:text-gray-300 cursor-pointer">{videoData.channel}</span>
                    <span className="text-xs text-gray-400">{videoData.subscribers} subscribers</span>
                  </div>
                  <button 
                    onClick={handleSubscribe}
                    className={`ml-4 px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 ${
                      subscribed 
                        ? "bg-[#272727] text-gray-300 border border-gray-700 hover:bg-[#3f3f3f]" 
                        : "bg-white text-black hover:bg-gray-200"
                    }`}
                  >
                    {subscribed ? <span className="flex items-center gap-2"><Check size={16}/> Subscribed</span> : "Subscribe"}
                  </button>
                </div>

                <div className="flex items-center gap-2 overflow-x-auto pb-2 md:pb-0 scrollbar-hide">
                  <div className="flex items-center bg-[#272727] rounded-full">
                    <button 
                      onClick={handleLike}
                      className={`flex items-center gap-2 px-4 py-2 rounded-l-full hover:bg-[#3f3f3f] border-r border-gray-600 transition-colors ${liked ? "text-blue-400" : "text-white"}`}
                    >
                      <ThumbsUp size={20} className={liked ? "fill-current" : ""} />
                      <span className="text-sm font-medium">{formatNumber(likeCount)}</span>
                    </button>
                    <button className="px-4 py-2 rounded-r-full hover:bg-[#3f3f3f] text-white">
                      <div className="rotate-180"><ThumbsUp size={20} /></div>
                    </button>
                  </div>
                  
                  <div className="relative">
                    <button 
                      onClick={handleShare}
                      className="flex items-center gap-2 bg-[#272727] px-4 py-2 rounded-full hover:bg-[#3f3f3f] text-white transition-colors"
                    >
                      <Share2 size={20} />
                      <span className="text-sm font-medium">Share</span>
                    </button>
                    {showShareTooltip && (
                      <div className="absolute top-full left-1/2 -translate-x-1/2 mt-2 bg-black text-white text-xs px-2 py-1 rounded opacity-90 transition-opacity">
                        Copied!
                      </div>
                    )}
                  </div>

                  <button className="flex items-center gap-2 bg-[#272727] px-3 py-2 rounded-full hover:bg-[#3f3f3f] text-white">
                    <MoreHorizontal size={20} />
                  </button>
                </div>
              </div>

              {/* Description Box */}
              <div 
                className={`bg-[#272727] rounded-xl p-3 text-sm mb-6 transition-all duration-200 cursor-pointer ${isDescriptionExpanded ? '' : 'hover:bg-[#3f3f3f]'}`}
                onClick={() => setIsDescriptionExpanded(!isDescriptionExpanded)}
              >
                <div className="flex gap-2 font-semibold mb-1">
                  <span>{videoData.views} views</span>
                  <span>â€¢</span>
                  <span>{videoData.date}</span>
                </div>
                <div className="relative">
                  <p className={`text-gray-200 whitespace-pre-line ${isDescriptionExpanded ? '' : 'line-clamp-2'}`}>
                    {videoData.description}
                  </p>
                  <span className={`text-gray-400 font-semibold mt-1 ${isDescriptionExpanded ? 'block pt-2' : 'block'}`}>
                    {isDescriptionExpanded ? 'Show less' : '...more'}
                  </span>
                </div>
              </div>

              {/* Comments Section */}
              <div className="mb-8">
                <div className="flex items-center gap-6 mb-6">
                  <h3 className="text-xl font-bold">8,432 Comments</h3>
                  <div className="flex items-center gap-2 text-sm font-medium text-gray-400 cursor-pointer">
                    <div className="w-5 h-5"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 18h6v-2H3v2zM3 6v2h18V6H3zm0 7h12v-2H3v2z"></path></svg></div>
                    Sort by
                  </div>
                </div>

                {/* Add Comment */}
                <div className="flex gap-4 mb-8">
                  <div className="w-10 h-10 rounded-full bg-gray-600 flex-shrink-0">
                     <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="User" className="rounded-full" />
                  </div>
                  <form onSubmit={handleCommentSubmit} className="flex-1">
                    <input 
                      type="text" 
                      value={commentText}
                      onChange={(e) => setCommentText(e.target.value)}
                      placeholder="Add a comment..."
                      className="w-full bg-transparent border-b border-gray-700 pb-1 focus:border-white focus:outline-none transition-colors text-sm"
                    />
                    <div className="flex justify-end mt-2 gap-2">
                      <button type="button" onClick={() => setCommentText('')} className="px-3 py-2 text-sm font-medium hover:bg-[#3f3f3f] rounded-full">Cancel</button>
                      <button 
                        type="submit" 
                        disabled={!commentText.trim()}
                        className={`px-3 py-2 text-sm font-medium rounded-full ${commentText.trim() ? "bg-blue-600 text-white hover:bg-blue-700" : "bg-[#272727] text-gray-500"}`}
                      >
                        Comment
                      </button>
                    </div>
                  </form>
                </div>

                {/* Comment List */}
                <div className="space-y-6">
                  {comments.map(comment => (
                    <div key={comment.id} className="flex gap-4 group">
                      <div className={`w-10 h-10 rounded-full ${comment.avatar} flex-shrink-0 flex items-center justify-center text-white font-bold text-sm`}>
                         {comment.user[0]}
                      </div>
                      <div className="flex-1">
                        <div className="flex items-baseline gap-2 mb-1">
                          <span className="font-semibold text-sm hover:text-gray-300 cursor-pointer">@{comment.user}</span>
                          <span className="text-xs text-gray-400">{comment.time}</span>
                        </div>
                        <p className="text-sm text-gray-200 mb-2">{comment.text}</p>
                        <div className="flex items-center gap-4 text-xs font-medium text-gray-400">
                          <button className="flex items-center gap-1 hover:bg-gray-800 p-1.5 -ml-1.5 rounded-full">
                            <ThumbsUp size={14} /> 
                            <span>{comment.likes}</span>
                          </button>
                          <button className="flex items-center gap-1 hover:bg-gray-800 p-1.5 rounded-full">
                            <div className="rotate-180"><ThumbsUp size={14} /></div>
                          </button>
                          <button className="hover:bg-gray-800 py-1.5 px-3 rounded-full">Reply</button>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </div>

            {/* Right Column: Recommendations */}
            <div className="lg:w-[350px] flex-shrink-0">
               <h3 className="font-bold text-lg mb-4 hidden lg:block">Up Next</h3>
               <div className="flex flex-col gap-3">
                  <RecommendationCard 
                    title="Behind the Scenes: Aether's Van Design" 
                    channel="Aether Official" 
                    views="1.2M views" 
                    time="1 week ago"
                    duration="10:05"
                    image="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=60"
                  />
                  <RecommendationCard 
                    title="Top 10 Street Foods in Hanoi You MUST Try" 
                    channel="Foodie Explorer" 
                    views="890K views" 
                    time="3 days ago"
                    duration="14:20"
                    image="https://images.unsplash.com/photo-1583417319070-4a69db38a482?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=60"
                  />
                  <RecommendationCard 
                    title="Cinematic Drone Footage of Ha Long Bay 4K" 
                    channel="Drone Master" 
                    views="3.4M views" 
                    time="1 year ago"
                    duration="05:30"
                    image="https://images.unsplash.com/photo-1528127269322-539801943592?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=60"
                  />
                   <RecommendationCard 
                    title="Packing for Van Life: Essentials Only" 
                    channel="Minimalist Travel" 
                    views="500K views" 
                    time="2 weeks ago"
                    duration="08:45"
                    image="https://images.unsplash.com/photo-1523987355523-c7b5b0dd90a7?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=60"
                  />
                    <RecommendationCard 
                    title="We Got Lost in the Mountains..." 
                    channel="Aether Official" 
                    views="2.1M views" 
                    time="2 days ago"
                    duration="18:12"
                    image="https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=60"
                  />
               </div>
            </div>

          </div>
        </main>
      </div>
    </div>
  );
};

// Sub-components for cleaner code
const RecommendationCard = ({ title, channel, views, time, duration, image }) => (
  <div className="flex gap-2 cursor-pointer group">
    <div className="relative w-40 h-24 flex-shrink-0 rounded-lg overflow-hidden bg-gray-800">
      <img src={image} alt={title} className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-200" />
      <div className="absolute bottom-1 right-1 bg-black/80 text-white text-xs px-1 rounded font-medium">
        {duration}
      </div>
    </div>
    <div className="flex flex-col gap-1 pr-4">
      <h4 className="text-sm font-semibold line-clamp-2 leading-tight group-hover:text-blue-400 transition-colors">{title}</h4>
      <div className="text-xs text-gray-400">
        <div>{channel}</div>
        <div>{views} â€¢ {time}</div>
      </div>
    </div>
  </div>
);

export default App;
